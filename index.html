<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>I oder i Spiel</title>
  <style>
    @font-face{
      font-family:'Schoulschreft';
      src:url('https://github.com/albrechtclaire1007/schoulschreft/raw/main/schoulschreft_bold%5B2%5D.TTF') format('truetype');
      font-weight:bold;
      font-display:swap;
    }
    :root{--blue:#4a90e2;--blueText:#2d5aa0;}
    *{box-sizing:border-box}
    body{
      font-family:'Schoulschreft', Arial, sans-serif;
      margin:0; padding:20px; background:#fff; min-height:100vh;
    }
    .game-container{max-width:1200px;margin:0 auto}
    .title{ text-align:center; font-size:1.8rem; margin:0 0 10px; color:var(--blueText); font-weight:bold; text-shadow:2px 2px 4px rgba(0,0,0,.1)}
    .toolbar{ display:flex; justify-content:center; align-items:center; gap:12px; margin:16px 0}
    .toggle{ display:inline-flex; align-items:center; gap:8px; font-size:1.1rem; cursor:pointer; user-select:none}
    .toggle input{ width:44px; height:24px; appearance:none; background:#ccc; border-radius:999px; position:relative; outline:none; transition:background .2s ease}
    .toggle input:checked{ background:var(--blue)}
    .toggle input::after{ content:""; position:absolute; top:3px; left:3px; width:18px; height:18px; background:#fff; border-radius:50%; transition:transform .2s ease}
    .toggle input:checked::after{ transform:translateX(20px)}
    .drop-zones{ display:flex; gap:15px; justify-content:center; padding:0 10px; margin-bottom:25px}
    .drop-box{
      width:45%; max-width:160px; height:200px; border:3px solid var(--blue);
      background:linear-gradient(145deg,#f8f9ff,#e8f2ff); display:flex; flex-direction:column; align-items:center;
      padding:15px; border-radius:15px; box-shadow:0 4px 12px rgba(74,144,226,.2); transition:.3s ease}
    .drop-box.drag-over{ background:linear-gradient(145deg,#fff2e6,#ffe6cc); border-color:#ff9500; transform:scale(1.02); box-shadow:0 8px 24px rgba(255,149,0,.3)}
    .drop-box h2{ font-size:2.5rem; margin:0 0 15px; color:var(--blue); font-weight:bold; text-shadow:2px 2px 4px rgba(0,0,0,.1)}
    .dropped-items{ display:flex; flex-wrap:wrap; gap:5px; align-items:center; justify-content:center; width:100%}
    .word-cards{ display:grid; grid-template-columns:repeat(4,1fr); gap:10px; max-width:100%; margin:0 auto; padding:0 10px}
    .word-card{
      width:100%; aspect-ratio:1; max-width:80px; border:2px solid #333; background:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center;
      cursor:grab; transition:transform .2s ease, box-shadow .2s ease; padding:8px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.1); touch-action:none}
    .word-card:hover{ transform:scale(1.05); box-shadow:0 4px 12px rgba(0,0,0,.15)}
    .word-card.dragging{ opacity:.5; cursor:grabbing}
    .word-image{ width:100%; height:100%; object-fit:cover; border-radius:8px; box-shadow:0 1px 4px rgba(0,0,0,.1)}
    .label{ margin-top:6px; font-size:1rem}
    .feedback{ text-align:center; margin-top:20px; font-size:1.5rem; font-weight:bold; min-height:40px}
    .correct{ color:#2d5016} .incorrect{ color:#8b0000}
    @media (max-width:768px){
      .word-cards{ grid-template-columns:repeat(3,1fr); gap:8px}
      .word-card{ max-width:70px; padding:6px}
      .feedback{ font-size:1.2rem; padding:0 15px}
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1 class="title">Sortiere die Wörter: I oder i?</h1>

    <div class="toolbar">
      <label class="toggle" title="Audio an/aus">
        <input type="checkbox" id="audioToggle" checked>
        <span>Ton an/aus</span>
      </label>
    </div>

    <div class="drop-zones">
      <div class="drop-box" id="capital-i-box" data-type="capital">
        <h2>I</h2>
        <div class="dropped-items" id="capital-items"></div>
      </div>
      <div class="drop-box" id="lowercase-i-box" data-type="lowercase">
        <h2>i</h2>
        <div class="dropped-items" id="lowercase-items"></div>
      </div>
    </div>

    <div class="word-cards" id="word-cards"></div>
    <div class="feedback" id="feedback"></div>
  </div>

  <script>
    // ---------- GAME DATA ----------
    // type: 'capital' = beginnt mit Groß-I; 'lowercase' = hat ein kleines i irgendwo im Wort
    const words = [
      { word: 'Igel',      type: 'capital',   image: 'https://i.postimg.cc/KR3my4FF/igel.jpg' },
      { word: 'Insel',     type: 'capital',   image: 'https://i.postimg.cc/JswM7m7S/insel.jpg' },
      { word: 'Italien',   type: 'capital',   image: 'https://i.postimg.cc/hXFc4g4k/italien.jpg' },
      { word: 'Indianer',  type: 'capital',   image: 'https://i.postimg.cc/WhqsPtjs/indianerkopf.jpg' },
      { word: 'Iglu',      type: 'capital',   image: 'https://i.postimg.cc/dLZJKDvw/iglu.jpg' },

      { word: 'Bleistift', type: 'lowercase', image: 'https://i.postimg.cc/dLZJKDvM/bleistift-neu.jpg' },
      { word: 'Fisch',     type: 'lowercase', image: 'https://i.postimg.cc/pp5Ptyxv/fisch.jpg' },
      { word: 'Schirm',    type: 'lowercase', image: 'https://i.postimg.cc/jDVtqKdK/schirm.jpg' },
      { word: 'Tiger',     type: 'lowercase', image: 'https://i.postimg.cc/jDVtqKdR/tiger.jpg' },
      { word: 'Mila',      type: 'lowercase', image: 'https://i.postimg.cc/QFLhNsxZ/mila.jpg' },
      { word: 'Ring',      type: 'lowercase', image: 'https://i.postimg.cc/FYtNFmst/ohrring-klein.jpg' }
    ];

    // ---------- AUDIO MAP ----------
    // Pattern given: https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/<file>.mp3
    const audioSrc = {
      Igel:      'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__igel.mp3',
      Insel:     'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__insel.mp3',
      Italien:   'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__italien.mp3',
      Indianer:  'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__Indianer.mp3',
      Iglu:      'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__Iglu.mp3',

      Bleistift: 'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__bleistift.mp3',
      Fisch:     'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__fisch.mp3',
      Schirm:    'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__Schirm.mp3',
      Tiger:     'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__Tiger.mp3',
      Mila:      'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__mila.mp3',
      Ring:      'https://github.com/albrechtclaire1007/Lauti/raw/refs/heads/main/I__ring.mp3'
      // If you later want to include "Milch": add image and 'I__Milch.mp3'
    };

    const audioPlayers = {};
    let soundOn = true;

    for (const [w, src] of Object.entries(audioSrc)) {
      const a = new Audio(src);
      a.preload = 'auto';
      audioPlayers[w] = a;
    }

    function playSound(word){
      if(!soundOn) return;
      const a = audioPlayers[word];
      if(!a) return;
      try{ a.currentTime = 0; a.play().catch(()=>{});}catch{}
    }

    // ---------- DND ----------
    let draggedElement = null;
    let correctPlacements = 0;
    let touchStartPos = {x:0,y:0}, isDragging = false;

    function createWordCards(){
      const container = document.getElementById('word-cards');
      words.forEach((w,i)=>{
        const card = document.createElement('div');
        card.className = 'word-card';
        card.draggable = true;
        card.dataset.word = w.word;
        card.dataset.type = w.type;
        card.dataset.index = i;

        card.innerHTML = `
          <img src="${w.image}" alt="${w.word}" class="word-image" onerror="this.style.display='none';">
          <div class="label">${w.word}</div>
        `;

        card.addEventListener('click', ()=>playSound(w.word));
        card.addEventListener('dragstart', handleDragStart);
        card.addEventListener('dragend', handleDragEnd);
        card.addEventListener('touchstart', handleTouchStart, {passive:false});
        card.addEventListener('touchmove', handleTouchMove, {passive:false});
        card.addEventListener('touchend', handleTouchEnd, {passive:false});

        container.appendChild(card);
      });
    }

    function handleDragStart(e){
      const card = e.target.closest('.word-card');
      draggedElement = card;
      card.classList.add('dragging');
      playSound(card.dataset.word);
    }
    function handleDragEnd(e){
      e.target.classList.remove('dragging');
      draggedElement = null;
    }
    function handleTouchStart(e){
      e.preventDefault();
      const t = e.touches[0];
      touchStartPos = {x:t.clientX, y:t.clientY};
      draggedElement = e.target.closest('.word-card');
      draggedElement.classList.add('dragging');
      isDragging = true;
      playSound(draggedElement.dataset.word);
    }
    function handleTouchMove(e){
      if(!isDragging || !draggedElement) return;
      e.preventDefault();
      const t = e.touches[0];
      const dx = t.clientX - touchStartPos.x;
      const dy = t.clientY - touchStartPos.y;
      draggedElement.style.transform = `translate(${dx}px, ${dy}px) scale(1.1)`;
      draggedElement.style.zIndex = '1000';
    }
    function handleTouchEnd(e){
      if(!isDragging || !draggedElement) return;
      e.preventDefault();
      const t = e.changedTouches[0];
      const elBelow = document.elementFromPoint(t.clientX, t.clientY);
      const dropBox = elBelow ? elBelow.closest('.drop-box') : null;

      draggedElement.style.transform = '';
      draggedElement.style.zIndex = '';
      draggedElement.classList.remove('dragging');

      if(dropBox){
        handleDrop({preventDefault(){}, target: dropBox});
      }
      isDragging = false;
      draggedElement = null;
    }

    function setupDropZones(){
      document.querySelectorAll('.drop-box').forEach(box=>{
        box.addEventListener('dragover', e=>e.preventDefault());
        box.addEventListener('dragenter', e=>{
          e.preventDefault();
          e.target.closest('.drop-box').classList.add('drag-over');
        });
        box.addEventListener('dragleave', e=>{
          const b = e.target.closest('.drop-box');
          if(!b.contains(e.relatedTarget)) b.classList.remove('drag-over');
        });
        box.addEventListener('drop', handleDrop);
      });
    }

    function handleDrop(e){
      e.preventDefault();
      const box = e.target.closest('.drop-box');
      box.classList.remove('drag-over');
      if(!draggedElement) return;

      const wordType = draggedElement.dataset.type;
      const boxType  = box.dataset.type;
      const word     = draggedElement.dataset.word;
      const feedback = document.getElementById('feedback');

      const tiny = draggedElement.cloneNode(true);
      tiny.style.width = '46px';
      tiny.style.height = '46px';
      tiny.style.padding = '2px';
      tiny.draggable = false;
      tiny.classList.remove('dragging');
      tiny.addEventListener('click', ()=>playSound(word));

      if(wordType === boxType){
        box.querySelector('.dropped-items').appendChild(tiny);
        draggedElement.remove();
        correctPlacements++;
        feedback.textContent = `Richtig! "${word}" gehört hier hin!`;
        feedback.className = 'feedback correct';

        if(correctPlacements === words.length){
          setTimeout(()=>{
            feedback.textContent = 'Super! Alle Wörter richtig sortiert! 🎉';
            feedback.className = 'feedback correct';
          }, 800);
        }
      }else{
        feedback.textContent = `Nicht ganz richtig. Versuche es nochmal mit "${word}".`;
        feedback.className = 'feedback incorrect';
      }

      setTimeout(()=>{
        if(correctPlacements < words.length){
          feedback.textContent = '';
          feedback.className = 'feedback';
        }
      }, 3000);
    }

    // ---------- INIT ----------
    document.addEventListener('DOMContentLoaded', ()=>{
      const toggle = document.getElementById('audioToggle');
      soundOn = toggle.checked;
      toggle.addEventListener('change', ()=> soundOn = toggle.checked);

      createWordCards();
      setupDropZones();
    });
  </script>
</body>
</html>
